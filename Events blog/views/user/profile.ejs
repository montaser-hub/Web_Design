<%- include('../partials/header') -%> <%- include('../partials/navbar') -%>
<div class="container">
  <div class="row mt-4">
    <div class="col-md-4 text-center">
      <img
        src="/uploads/images/<%= user.avatar %>"
        alt="Profile Picture"
        class="img-fluid rounded-circle mb-3"
        style="max-width: 150px"
      />
      <h1 class="display-4">Profile</h1>
      <p><% if (user) { %> Welcome, your email: <%= user.email %> <% } %></p>
    </div>
    <div class="col-md-8">
      <%- include('../partials/flashMessages') -%>
      <form
        id="uploadForm"
        action="/users/uploadAvatar"
        method="POST"
        enctype="multipart/form-data"
        onsubmit="return validateUpload()"
      >
        <div class="form-group">
          <label for="avatar">Upload Profile Picture</label>
          <input
            type="file"
            name="avatar"
            id="avatar"
            class="form-control-file"
            onchange="readURL(this)"
          />
        </div>
        <button type="submit" class="btn btn-primary">Upload</button>
      </form>

      <hr />
      <h1 class="display-4">Image Preview</h1>
      <img
        src="#"
        alt="Image Preview"
        id="imagePlaceholder"
        class="img-fluid mt-3"
        height="200px"
        width="200px"
        style="max-width: 200px; display: none"
      />
    </div>
  </div>
</div>
<%- include('../partials/footer') -%>

<script>
  function validateUpload() {
    var fileInput = document.getElementById("avatar");
    if (fileInput.files.length === 0) {
      alert("Please select an image to upload");
      return false;
    }
    return true;
  }
</script>
